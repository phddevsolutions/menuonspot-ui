<!DOCTYPE html>
<html lang="pt">
    <head>
        <meta name="description" content="menuonspot">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
         <title>Menu On Spot</title>
         <link rel="icon" type="image/x-icon" href="/logo.ico">
        <link rel="shortcut icon" type="image/x-icon"  href="/logo.ico">

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link rel="stylesheet" href="index.css">
        <link rel="stylesheet" href="header.css">
        <link rel="stylesheet" href="filter.css">
        <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">

        <!-- Google Fonts -->
         <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Jost:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
         <link rel="preconnect" href="https://fonts.googleapis.com">
         <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
         <link href="https://fonts.googleapis.com/css2?family=Figtree:wght@400;700&display=swap" rel="stylesheet">
         <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    </head>
    <body>
        
                     <div id="header-placeholder"></div>
                   <div id="index-section-placeholder"></div> 
                    <div id="footer-placeholder"></div> 
        
        <script src="architecture.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                buildArchitecture(function () {
                console.log('Toda a arquitetura foi carregada!')
                })
            })
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="lang-switcher.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
        
         <script>
             AOS.init();
        </script>


       <script>
(function () {
  const DEBUG = false; // true para ver logs

  function log(...args) { if (DEBUG) console.log('[scroll-priority]', ...args); }

  // Init: tenta obter o menu; se não existir, observa o DOM até aparecer
  function waitForMenu(timeout = 5000) {
    return new Promise((resolve) => {
      const el = document.getElementById('menu-placeholder');
      if (el) return resolve(el);

      const container = document.getElementById('index-section-placeholder') || document.body;
      const observer = new MutationObserver((mutations) => {
        const found = document.getElementById('menu-placeholder');
        if (found) {
          observer.disconnect();
          resolve(found);
        }
      });
      observer.observe(container, { childList: true, subtree: true });

      // fallback timeout
      setTimeout(() => {
        const found = document.getElementById('menu-placeholder');
        observer.disconnect();
        resolve(found);
      }, timeout);
    });
  }

  function installScrollPriority(menu) {
    if (!menu) {
      console.warn('scroll-priority: #menu-placeholder não encontrado.');
      return;
    }
    log('installing on', menu);

    // Helper to test where menu is (top/bottom)
    function atTop() {
      return menu.scrollTop <= 0;
    }
    function atBottom() {
      return Math.abs(menu.scrollHeight - menu.scrollTop - menu.clientHeight) <= 1;
    }

    // WHEEL handler
    const onWheel = (event) => {
      if (!menu) return;
      let delta = event.deltaY;
      // normaliza deltaMode
      if (event.deltaMode === 1) delta *= 16;
      else if (event.deltaMode === 2) delta *= menu.clientHeight;

      const wantScrollDown = delta > 0;
      const canScrollMenu = (wantScrollDown && !atBottom()) || (!wantScrollDown && !atTop());

      if (canScrollMenu) {
        event.preventDefault();
        // aplica scroll ao menu
        menu.scrollBy({ top: delta, left: 0, behavior: 'auto' });
        log('wheel -> routed to menu', delta, 'scrollTop:', menu.scrollTop);
      } else {
        log('wheel -> let page handle (menu at edge)');
        // deixa o evento propagar para o documento (page scroll)
      }
    };

    // TOUCH handling (for mobile / touchpads)
    let touchStartY = null;
    let lastY = null;
    const onTouchStart = (e) => {
      if (e.touches && e.touches.length === 1) {
        touchStartY = lastY = e.touches[0].clientY;
      }
    };
    const onTouchMove = (e) => {
      if (touchStartY === null) return;
      const currentY = e.touches[0].clientY;
      const dy = lastY - currentY; // positive -> scroll down
      lastY = currentY;

      const wantScrollDown = dy > 0;
      const canScrollMenu = (wantScrollDown && !atBottom()) || (!wantScrollDown && !atTop());

      if (canScrollMenu) {
        e.preventDefault(); // requires passive: false
        menu.scrollBy({ top: dy, left: 0, behavior: 'auto' });
        log('touch -> routed to menu', dy, 'scrollTop:', menu.scrollTop);
      } else {
        log('touch -> let page handle (menu at edge)');
      }
    };

    // Regista listeners no capture phase com passive:false para garantir controle
    window.addEventListener('wheel', onWheel, { passive: false, capture: true });
    window.addEventListener('mousewheel', onWheel, { passive: false, capture: true });
    window.addEventListener('DOMMouseScroll', onWheel, { passive: false, capture: true });

    window.addEventListener('touchstart', onTouchStart, { passive: true, capture: true });
    window.addEventListener('touchmove', onTouchMove, { passive: false, capture: true });

    // Guarda referências para eventual cleanup (não necessário agora)
    menu.__scrollPriority = { onWheel, onTouchStart, onTouchMove };
  }

  // Public init: espera o menu e instala o comportamento
  async function initScrollPriority() {
    const menu = await waitForMenu(8000); // espera até 8s pela injeção
    if (!menu) {
      console.warn('scroll-priority: #menu-placeholder não apareceu dentro do tempo.');
      return;
    }
    installScrollPriority(menu);
  }

  // Auto-init
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initScrollPriority);
  } else {
    initScrollPriority();
  }

  // optional: expõe função global para reiniciar (se re-injetares o menu)
  window.__initScrollPriority = initScrollPriority;
})();
</script>
  <script src="scrollspy.js"></script>


    </body>
</html>